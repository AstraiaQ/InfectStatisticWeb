<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="layui/css/layui.css">
</head>

<body class="layui-bg-black" >

    <!-- 下面是导航栏-->
    <ul class="layui-nav layui-bg-green" lay-filter="">
        <li class="layui-nav-item layui-this"><a href="">疫情动态</a></li>
        <li class="layui-nav-item"><a href="javascript:;">迁徙地图</a>
            <dl class="layui-nav-child layui-bg-green">
                <!-- 二级菜单 -->
                <dd><a href="">热门迁入地</a></dd>
                <dd><a href="">热门迁出地</a></dd>
            </dl></li>
        <li class="layui-nav-item"><a href="">全民热搜</a></li>
        <li class="layui-nav-item"><a href="">实时播报</a>
        </li>
    </ul>

    <!-- 下面是轮播图 -->
    <div class="layui-carousel" id="test1" style="margin:0 auto;">
        <div carousel-item>
            <div><img src="images\/5fdf8db1cb13495468e93e6251ecc75ed0094a6d.jpg" ，style="CURSOR: hand"
                    οnclick='window.open("https://baijiahao.baidu.com/s?id=1660753468784088427&wfr=spider&for=pc")'>
            </div>
            <div>条目2</div>
            <div>条目3</div>
            <div>条目4</div>
            <div>条目5</div>
        </div>
    </div>

    <!-- 下面是地图区 -->
    <div class="layui-main" id="laotang" style="width: 800px; height:600px;"></div>

    <script src="layui/layui.js"></script>


    <script>
        layui.use('laytpl', function () {
            var laytpl = layui.laytpl;

            var getTpl = demo.innerHTML
                , view = document.getElementById('view');
            laytpl(getTpl).render(data, function (html) {
                view.innerHTML = html;
            });
        });
    </script>


    <!-- 引入所需的JS文件 -->
    <script src="echarts.min.js"></script>
    <script src="china.js"></script>
    <script src="jquery-1.12.4.min.js"></script>

    <!--轮播图部分-->
    <script>
        layui.use('carousel', function () {
            var carousel = layui.carousel;
            //建造实例
            carousel.render({
                elem: '#test1'
                , width: '40%' //设置容器宽度
                , arrow: 'none' //始终显示箭头
                //,anim: 'updown' //切换动画方式
            });
        });
    </script>

    <script>
        // 获取真实的数据

        $.get("http://api.tianapi.com/txapi/ncovcity/index?key=5d4fb67d8bd16c1fd371311e334a4bd0",
            function (data, status) {
                // console.log(data); // data就是获取到的数据，输出到控制台查看
                var arr = [];
                // 处理数据，成地图需要的数据结构
                data.newslist.forEach(item => {
                    // 循环的过程中，向空数组中加入所需的内容
                    arr.push({
                        name: item.provinceShortName, // name固定
                        value: item.confirmedCount, // value固定
                        zuixin: item.currentConfirmedCount, // 当前确诊
                        zhiyu: item.curedCount,
                        siwang: item.deadCount
                    });
                });
                // 循环结束之后，我们就得到了地图需要的数据了。数据是arr，但是还稍微有点问题
                // 手动自行添加一个南海诸岛的数据
                arr.push({
                    name: '南海诸岛', // name固定
                    value: '未统计', // value固定
                    zuixin: '未统计', // 当前确诊
                    zhiyu: '未统计',
                    siwang: '未统计'
                });
                // 到此为止，所有的数据全部处理好了。
                console.log(arr);

                // 下面开始做地图
                // 1. 初始化
                var myChart = echarts.init(document.getElementById('laotang'));

                // 2. 配置
                var option = {
                    // 标题部分
                    title: {
                        text: '众志成城，抗击疫情',
                        textStyle: {
                            fontSize: 28
                        },
                        left: 'center', // 左右居中
                        subtext: '传智播客前端与移动开发教研部',
                        subtextStyle: {
                            fontSize: 14
                        }
                    },
                    // 设置地图及数据
                    series: [{
                        type: 'map',
                        map: 'china', // 指定是中国地图
                        data: arr, // 设置地图中的数据
                        label: { // 控制默认显示省的名字
                            show: true
                        }
                    }],
                    tooltip: { // 鼠标悬浮提示
                        enterable:true,
                        triggerOn:'click',
                        position:'right',
                        formatter: function (params) { 
                            var result = '累计确诊：'+params.data.value+'<br/>'+
                                '当前确诊：'+params.data.zuixin+'<br/>'+
                                '治愈：'+params.data.zhiyu+'<br/>'+
                                '死亡：'+params.data.siwang+'<br/>'+
                                '<input type="submit" value="详情" onclick=window.open(\"http://www.baidu.com\")>';
                            return result;
                        }
                    },
                    visualMap: {
                        type: 'piecewise',
                        pieces: [
                            { gt: 10000 }, // 大于10000
                            { gt: 5000, lte: 10000 },
                            { gt: 1000, lte: 5000 },
                            { gt: 500, lte: 1000 },  // (900, 1500]
                            { gt: 100, lte: 500 },  // (310, 1000]
                            { gt: 10, lte: 100 },   // (200, 300]
                            { gt: 0, lte: 10 },       // (0, 10]
                        ],
                        inRange: {
                            color: ['#ffcfc3', '#eda595', '#d27b64', '#d5462a', '#a8352e', '#6a211d', '#562a2a']
                        }
                    }
                };

                // 3. 生成地图
                myChart.setOption(option);
            });


    </script>

    <!-- element模块加载-->
    <script>
        //注意：折叠面板 依赖 element 模块，否则无法进行功能性操作
        layui.use('element', function () {
            var element = layui.element;

            //…
        });
    </script>

</body>

</html>