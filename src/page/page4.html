<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>实时新闻</title>
  <link rel="stylesheet" href="../layui/css/layui.css">
  <link rel="stylesheet" href="../css/page4.css">
  <script type="text/javascript" src="../jquery-1.12.4.min.js"></script>
  <script src="../layui/layui.js"></script>
</head>

<body>
  <!-- 下面是导航栏-->
  <!-- 下面是导航栏-->
  <ul class="layui-nav layui-bg-green" lay-filter="" style="width: 100%;">
    <li class="layui-nav-item"><a href="../index.html">疫情动态</a></li>
    <li class="layui-nav-item"><a href="page3.html">辟谣中心</a></li>
    <li class="layui-nav-item  layui-this"><a href="page4.html">热点新闻</a>
    </li>
  </ul>
  <div class="layui-main" style="width: 800px; height:600px;">
    <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
      <legend >实时新闻</legend>(点击内容可查看更多详情)
    </fieldset>
    <ul class="layui-timeline">
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem0" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo0"></p>
          </h3>
          <p id="demoo0">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem1" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo1"></p>
          </h3>
          <p id="demoo1">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem2" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo2"></p>
          </h3>
          <p id="demoo2">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem3" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo3"></p>
          </h3>
          <p id="demoo3">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem4" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo4"></p>
          </h3>
          <p id="demoo4">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem5" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo5"></p>
          </h3>
          <p id="demoo5">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem6" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo6"></p>
          </h3>
          <p id="demoo6">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem7" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo7"></p>
          </h3>
          <p id="demoo7">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem8" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo8"></p>
          </h3>
          <p id="demoo8">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <a id="dem9" href="">
        <div class="layui-timeline-content layui-text">
          <h3 class="layui-timeline-title">
            <p id="demo9"></p>
          </h3>
          <p id="demoo9">
          </p>
        </div>
        </a>
      </li>
      <li class="layui-timeline-item">
        <i class="layui-icon layui-timeline-axis"></i>
        <div class="layui-timeline-content layui-text">
          <div class="layui-timeline-title">over</div>
        </div>
      </li>
    </ul>
  </div>




  <script>
    var dataUrl = "https://lab.ahusmart.com/nCoV/";
    var dataUrlBackup = "https://lab.ahusmart.com/nCoV/";
    //获取实时新闻
    $(document).ready(function () {
      initNews();
    });

    var initNews = function () {
      $.ajax({
        url: dataUrl + 'api/news',
        type: 'get',
        success: function (res) {
          if (res.success === true) {
            console.log(res);
            var news = res.results;
            for (var i in news) {
              x=document.getElementById("demo"+i);
              x.innerHTML=news[i].title;
              y=document.getElementById("demoo"+i);
              y.innerHTML=news[i].summary;
              z=document.getElementById("dem"+i).href=news[i].sourceUrl;
            }
            return;
          }
          alert("获取数据失败");
        },
        error: function (res) {
          if (res.state() === "rejected" && !this.url.includes(dataUrlBackup)) {
            this.url = this.url.replace(dataUrl, dataUrlBackup);
            $.ajax(this);
          }
        }
      })

    };

  </script>



  <script>
    function changePage() {
      window.open("http://www.baidu.com");
    }
  </script>

  <!-- element模块加载-->
  <script>
    //注意：折叠面板 依赖 element 模块，否则无法进行功能性操作
    layui.use('element', function () {
      var element = layui.element;

      //…
    });
  </script>
</body>

</html>